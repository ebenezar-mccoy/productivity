# $Id: zshrc,v 2.0 2015/10/15 12:00:00 makowsm Exp $


# Use hard limits, except for a smaller stack and no core dumps
unlimit
limit stack 8192
limit core 0
limit -s

# paths
path=(
/opt/chefdk/bin
/opt/chefdk/embedded/bin
/Users/makowsm/.chefdk/gem/ruby/2.3.0/bin
/usr/local/bin
/bin
/usr/bin
/sbin
/usr/sbin
/usr/local/sbin
)

manpath=(
/usr/man
/usr/share/man
/usr/X11R6/man
/usr/local/man
)

fpath=(~/.zsh/functions/ $fpath)

export path manpath
typeset -U path manpath

# exports
export HISTFILE=${HOME}/.zsh_history
export HISTSIZE=50000
export SAVEHIST=50000
export REPORTTIME=10
export EDITOR='vim'
export NULLCMD=:
export LC_CTYPE=en_US.UTF-8
export LESSCHARSET=utf-8
export PAGER='less'
export TERM=screen-256color
#export CLASSPATH=.:/home/mariusz.makowski/libs/jruby-1.7.2/lib/jruby.jar

# aliases
alias vi="vim"
alias ls='ls -F'
alias lsl="ls -ltSrhF"
alias mv='nocorrect mv'
alias mv='noglob mv'
#alias cp='nocorrect cp'
alias find='noglob find'
alias mkdir='nocorrect mkdir'
alias grep='egrep'
alias lsd='ls -ld *(-/DN)'
alias sgrep='egrep -v "^$|^#"'
alias python='python3'

alias tmux='tmux -2'
alias sublime='sublime --command toggle_full_screen'
# hashes

hash -d log="/var/log"
#hash -d cookbooks="/Users/makowsm/Documents/cookbooks"
hash -d mplatform="/Users/makowsm/Documents/mplatform"
hash -d deopsit="/Users/makowsm/Documents/deposit"

# keybinds
bindkey -e
bindkey ' '  magic-space
bindkey '^I' complete-word

bindkey '^A' beginning-of-line
bindkey '^E' end-of-line
bindkey '^F' emacs-forward-word
bindkey '^B' emacs-backward-word
bindkey '^w' backward-delete-word
bindkey '^[' insert-last-word

autoload predict-on
predict-toggle() {
((predict_on=1-predict_on)) && predict-on || predict-off
}
zle -N predict-toggle
bindkey '^Z'   predict-toggle
zstyle ':predict' toggle true
zstyle ':predict' verbose true

# sets
setopt \
  brace_ccl inc_append_history hist_ignore_space \
  hist_no_store hist_no_functions hist_ignore_all_dups \
  hist_expire_dups_first no_hup \
  no_check_jobs autocd autolist autopushd autoresume \
  cdablevars extendedglob globdots longlistjobs \
  noclobber notify pushdminus pushdsilent \
  pushdtohome rcquotes sunkeyboardhack recexact \
  correct complete_in_word promptsubst

# unset
#unsetopt bgnice autoparamslash cdablevars
unset mailpath MAILCHECK MAIL

# mass move
autoload -U zmv

# completions
zmodload -i zsh/complist
zstyle ':completion:*' menu select=4

autoload -U compinit
compinit -u

zstyle ':completion:*::::' completer _expand _complete _ignored #_approximate
zstyle ':completion:*:expand:*' tag-order all-expansions

zstyle ':completion:*' verbose yes
zstyle ':completion:*:descriptions' format '%B%d%b'
zstyle ':completion:*:messages' format '%d'
zstyle ':completion:*:warnings' format 'No matches for: %d'
zstyle ':completion:*:corrections' format '%B%d (errors: %e)%b'

zstyle ':completion:*:*:-subscript-:*' tag-order indexes parameters
zstyle ':completion:*:processes' command 'ps -x -o pid,nice,pcpu,tt,args'

zstyle ':completion:*:*:(^rm):*:*files' ignored-patterns \
  '*?.o' '*~' # '*?.orig'

zstyle ':completion:*:functions' ignored-patterns '_*'

# zsh speed up completions
zstyle ':completion:*' accept-exact '*(N)'

zstyle ':completion:*' use-cache on
zstyle ':completion:*' cache-path ~/.zsh/cache

local _myhosts
_myhosts=( ${${${${(f)"$(<$HOME/.ssh/known_hosts)"}:#[0-9]*}%%\ *}%%,*} )
zstyle ':completion:*(scp|ssh):*' hosts $_myhosts
local _myusers
_myusers=( 'mariusz.makowski' 'root' )
zstyle ':completion:*:(scp|ssh):*' users $_myusers

# colors
autoload -U colors
colors

export LS_COLORS='no=00:fi=00:di=01;34:ln=00;36:pi=40;33:so=00;35:bd=40;33;00:cd=40;33;00:or=40;31;00:ex=00;32:*.tar=00;31:*.tgz=00;31:*.rar=00;31:*.ace=00;31:*.zip=00;31:*.bz2=00;31:*.rpm=00;31:*.gz=00;31:*.jpg=00;35:*.gif=00;35:*.bmp=00;35:*.png=00;35:*.tga=00;35:*.xpm=00;35:*.mpg=00;37:*.avi=00;37:*.mov=00;37:*.mp3=01;35:*.flac=01;35:*.ogg=01;35:*.mpc=01;35:*.wav=01;35:*.ape=01;35:*.core=00;33'
export CLICOLOR='no=00:fi=00:di=01;34:ln=00;36:pi=40;33:so=00;35:bd=40;33;00:cd=40;33;00:or=40;31;00:ex=00;32:*.tar=00;31:*.tgz=00;31:*.rar=00;31:*.ace=00;31:*.zip=00;31:*.bz2=00;31:*.rpm=00;31:*.gz=00;31:*.jpg=00;35:*.gif=00;35:*.bmp=00;35:*.png=00;35:*.tga=00;35:*.xpm=00;35:*.mpg=00;37:*.avi=00;37:*.mov=00;37:*.mp3=01;35:*.flac=01;35:*.ogg=01;35:*.mpc=01;35:*.wav=01;35:*.ape=01;35:*.core=00;33'
zstyle ':completion:*' list-colors $LS_COLORS

# prompt
#local PromptColor=$(echo '%{\e[36m%}%{\e[01;37m%}%{\e[22;39m%}%{\e[33m%}%35<...<%{\e[39m%}')

source ~/.zsh/zsh-git-prompt/zshrc.sh
precmd () {
  prompt="%{$fg_no_bold[blue]%}%~%b$(git_super_status)%  %(!|%{$fg_no_bold[yellow]%}|%{$fg_bold[black]%})%(?..%{$fg[red]%})%#%{$fg_no_bold[default]%} "
}

# source ~/.zsh/prompt.zsh
# precmd () {
#   prompt="%{$fg_no_bold[blue]%}%~ %b$(git_prompt_string)% %(!|%{$fg_no_bold[yellow]%}|%{$fg_bold[black]%})%(?..%{$fg[red]%})%#%{$fg_no_bold[default]%} "
# }

# functions
reload () {
  exec $SHELL $SHELL_ARGS "$@"
}

saneperms()
{
  find . -type d -print0| xargs -r -0 chmod 755
  find . -type f -print0| xargs -r -0 chmod ${1:=644}
}

function mdcat()
{
  cat $* | markdown | html2text
}

# clipboard
set clipboard=unnamed

# scripts
source /usr/local/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
ZSH_HIGHLIGHT_HIGHLIGHTERS=(main brackets pattern cursor)

# eval "$(docker-machine env default)"

# fzf
[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh
FZF_DEFAULT_OPTS='--multi --reverse --height=20%'
FZF_CTRL_R_OPTS='--sort'
#FZF_TMUX='1'
#FZF_TMUX_HEIGHT='20%'

# ctrlp
ctrlp() {
  </dev/tty vim -c CtrlP
}
zle -N ctrlp
bindkey "^p" ctrlp

hash -d spdp="/Users/makowsm/Documents/spdp"
function spdp() {
  export KNIFE_HOME=~spdp
  cd ~spdp
}
#spdp
